/*6.  For every database, rank them according to number of NN (Not Null) have created*/
SELECT D.TABLE_CATALOG,D.number_of_NN, RANK() OVER(ORDER by D.number_of_NN DESC) as RANK
FROM 
((SELECT TABLE_CATALOG , COUNT(COLUMN_NAME) as number_of_NN from [Zeota].INFORMATION_SCHEMA.COLUMNS
WHERE IS_NULLABLE = 'NO'
GROUP BY TABLE_CATALOG
UNION
SELECT TABLE_CATALOG, COUNT(COLUMN_NAME) as number_of_NN from [SP].INFORMATION_SCHEMA.COLUMNS
WHERE IS_NULLABLE = 'NO'
GROUP BY TABLE_CATALOG
UNION
SELECT TABLE_CATALOG, COUNT(COLUMN_NAME) as number_of_NN from [PROP].INFORMATION_SCHEMA.COLUMNS
WHERE IS_NULLABLE = 'NO'
GROUP BY TABLE_CATALOG
UNION
SELECT TABLE_CATALOG, COUNT(COLUMN_NAME) as number_of_NN from [DGDB].INFORMATION_SCHEMA.COLUMNS
WHERE IS_NULLABLE = 'NO'
GROUP BY TABLE_CATALOG))D
ORDER BY D.number_of_NN DESC

/*
TABLE_CATALOG	number_of_NN	RANK
Zeota	105	1
DGDB	68	2
PROP	10	3
SP	4	4
*/